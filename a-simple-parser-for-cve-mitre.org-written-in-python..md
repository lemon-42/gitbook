# A simple parser for cve-mitre.org written in Python.

## A simple parser for cve-mitre.org written in Python.

In today's episode, a smart guy give me a job. A python job. In case if you don't know (i know you don't), i'm a student in IT. My goal is to work in cybersecurity. I have no idea for now if one day my dream will became true, but no more blabla about me, let's jump into this python parser.

### The program itself

As i say in the little introduction, i was given a job to parse some CVE details. On cve-mitre the description is not that explicit, but it's a good way to start on. I'm a beginner in Python, so it might not be the best to do what i want to do, but it seem's okay to me.

The first thing I need to do is to import some packages that i need for this project, there are three of them :

```python
import requests
import sys
from bs4 import BeautifulSoup
```

The `import request` library will be use to GET all the information i need on the page i want. It will be in addition of the `get` function included in requests. My main function with this packages looks like this :

```python
def get_cve_data(cve_id):
  url = 'https://cve.mitre.org/cgi-bin/cvename.cgi?name=' + cve_id
  response = requests.get(url)
  return response.text
```

At this point i was able to get all the HTML/CSS of the page. Now, we need to parse the HTML/CSS to get the information we want.

To do this, i use `BeautifulSoup`. It's the very first time i use this package (remember, i'm new to python), but i find it perfect for what i need. It will help me to extract the data i wanted on the HTML we just get with my precedent function. I need to tell that i was struggling a lot to find the information that i want. I try to use the `xpath` to parse the data but without much success. But the amazing `BeautifulSoup` was the right things for me to use. Let's jump into the function :

```python
def parse_cve_data(cve_data):
  soup = BeautifulSoup(cve_data, 'html.parser')
  cve_description = soup.find_all('th')[1].text.strip() + '\n' +(' ').join(soup.find_all('td')[10].text.strip().split())
  return cve_description
```

As you can see, my variable `cve_description` is pretty ugly, but I will try to explain it as best as I can. First I use the object `BeautifulSoup` which is used to represents the documents as a nested data structure, allowing easy access to different elements of the page using search and navigation methods. Next, the big one.

The `soup.find_all()` method looks through a tag's descendants and retrieve all descendants that match our filters. So this method will get all the `th` tag in the HTML. The `[1]` index is used to get the description fields. I remove all the blank spaces with the `strip()` method.

The next thing to do is to get the actual description of the CVE. On cve-mitre.org, the description is as basic as simple. To get the description, I reuses the `soup.find_all()` method. This time, it's in a `td` tag on the website. I also need to find the one i wanted, so that's why there is a `[10]` index here. Next, strip and split all the line together to have the line correctly formatted.

That's it for this function, which is the primary function for this project. It's now almost finish, except that I want to write all the information i get in a file. To do this, nothing more simple that use another function to do this, right ? :)

```python
def write_to_file(cve_description):
  with open('CVE.txt', 'w') as f:
    f.write(cve_description)
```

The purpose of this function is to create a text file named `CVE.txt` and to write the variable `cve_description` that we have previously created in this file. The use of the syntax `with open` allows to manage automatically the closing of the file after the writing.

Finally, we need to write our main function for the programs to work, let's do this :

```python
def main():
    cve_id = sys.argv[1]
    cve_data = get_cve_data(cve_id)
    cve_description = parse_cve_data(cve_data)
    write_to_file(cve_description)

if __name__ == '__main__':
    main()
```

And voil√† ! If you want to retrieve the full code for this program, just follow this link : https://github.com/lemon-42/cve-parser
